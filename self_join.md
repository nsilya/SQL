
–¢–∞–±–ª–∏—Ü–∞ `Employee`:

| id | name | department | managerId |
|----|------|------------|-----------|
| ...| ...  | ...        | ...       |

- `id` ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ (–ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á).
- `managerId` ‚Äî –Ω–æ–º–µ—Ä –µ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ (—Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ `id` –¥—Ä—É–≥–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞).
- –ï—Å–ª–∏ `managerId IS NULL` ‚Äî —É —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ **–Ω–µ—Ç —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è**.
- –ù–∏–∫—Ç–æ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–≤–æ–∏–º —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º.

---

### üî∑ **–ß—Ç–æ –Ω—É–∂–Ω–æ –Ω–∞–π—Ç–∏?**
> **–ú–µ–Ω–µ–¥–∂–µ—Ä–æ–≤, —É –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ –º–µ–Ω—å—à–µ –ø—è—Ç–∏ –ø—Ä—è–º—ã—Ö –ø–æ–¥—á–∏–Ω—ë–Ω–Ω—ã—Ö.**  
–¢–æ –µ—Å—Ç—å: —Ç–∞–∫–∏—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ `X`, –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö —Å—É—â–µ—Å—Ç–≤—É–µ—Ç **‚â•5 –∑–∞–ø–∏—Å–µ–π** –≤ —Ç–∞–±–ª–∏—Ü–µ, –≥–¥–µ `managerId = X.id`.

–í–∞–∂–Ω–æ: **–≤—ã–≤–æ–¥–∏—Ç—å –Ω—É–∂–Ω–æ –∏–º–µ–Ω–Ω–æ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤** ‚Äî —Ç–æ –µ—Å—Ç—å –∏—Ö **–∏–º–µ–Ω–∞**, –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ id –∏–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥—á–∏–Ω—ë–Ω–Ω—ã—Ö.

---

### üî∑ **–ö–∞–∫ —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å?**
–ü–æ–¥—É–º–∞–π –ª–æ–≥–∏—á–µ—Å–∫–∏:

1. **–°—á–∏—Ç–∞–µ–º**, —Å–∫–æ–ª—å–∫–æ –ø–æ–¥—á–∏–Ω—ë–Ω–Ω—ã—Ö —É –∫–∞–∂–¥–æ–≥–æ `managerId`.
   - –≠—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `GROUP BY managerId`.
   - –ù–æ —Å–Ω–∞—á–∞–ª–∞ –Ω—É–∂–Ω–æ –∏—Å–∫–ª—é—á–∏—Ç—å `NULL` ‚Äî –≤–µ–¥—å —É –∫–æ–≥–æ-—Ç–æ –Ω–µ—Ç –º–µ–Ω–µ–¥–∂–µ—Ä–∞, –∏ —ç—Ç–æ –º—É—Å–æ—Ä –¥–ª—è –Ω–∞—à–µ–π –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏.

2. **–û—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ —Ç–µ—Ö**, —É –∫–æ–≥–æ –ø–æ–¥—á–∏–Ω—ë–Ω–Ω—ã—Ö ‚â•5:
   - –ò—Å–ø–æ–ª—å–∑—É–µ–º `HAVING COUNT(*) >= 5`.

3. **–ù–æ!** –í —ç—Ç–æ–π –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–µ —É –Ω–∞—Å –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ `managerId` (—á–∏—Å–ª–æ), –∞ **–Ω—É–∂–Ω–æ –∏–º—è**.
   - –ó–Ω–∞—á–∏—Ç, –Ω–∞–¥–æ **–ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å** —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫ –∏—Å—Ö–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ, —á—Ç–æ–±—ã –ø–æ–¥—Å—Ç–∞–≤–∏—Ç—å `name`.

---

### üî∑ **–ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∑–∞–ø—Ä–æ—Å ‚Äî –ø–æ —á–∞—Å—Ç—è–º**

```sql
SELECT e.name
FROM Employee e
JOIN (
    SELECT managerId
    FROM Employee
    WHERE managerId IS NOT NULL
    GROUP BY managerId
    HAVING COUNT(*) >= 5
) AS reports ON e.id = reports.managerId;
```

#### –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –ø–æ–¥–∑–∞–ø—Ä–æ—Å:
```sql
SELECT managerId
FROM Employee
WHERE managerId IS NOT NULL
GROUP BY managerId
HAVING COUNT(*) >= 5
```
‚Üí –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ `managerId`, —É –∫–æ—Ç–æ—Ä—ã—Ö **5 –∏–ª–∏ –±–æ–ª–µ–µ –ø–æ–¥—á–∏–Ω—ë–Ω–Ω—ã—Ö**.

#### –í–Ω–µ—à–Ω–∏–π –∑–∞–ø—Ä–æ—Å:
```sql
SELECT e.name
FROM Employee e
JOIN (...) AS reports ON e.id = reports.managerId;
```
‚Üí –ë–µ—Ä—ë—Ç —ç—Ç–∏—Ö –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ –ø–æ `id` –∏ **–¥–æ—Å—Ç–∞—ë—Ç –∏—Ö –∏–º–µ–Ω–∞**.

---

### üî∑ **–ü–æ—á–µ–º—É –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–æ—Å—Ç–æ–π GROUP BY –ø–æ name?**
–ü–æ—Ç–æ–º—É —á—Ç–æ:
- `name` –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—É–Ω–∏–∫–∞–ª—å–Ω—ã–º (–¥–≤–æ–µ –ò–≤–∞–Ω–æ–≤ ‚Äî –æ–¥–∏–Ω –º–µ–Ω–µ–¥–∂–µ—Ä, –¥—Ä—É–≥–æ–π ‚Äî –Ω–µ—Ç).
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –Ω—É–∂–Ω–æ **–ø–æ id –º–µ–Ω–µ–¥–∂–µ—Ä–∞**, –∞ –Ω–µ –ø–æ –∏–º–µ–Ω–∏.
- –ü–æ—ç—Ç–æ–º—É —Å–Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç–∞–µ–º —Å `id`, –ø–æ—Ç–æ–º **—Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω—è–µ–º –∏–º—è.

---

### üî∑ **–ß—Ç–æ, –µ—Å–ª–∏ —è –ø—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à—É:**
```sql
SELECT name
FROM Employee
GROUP BY managerId
HAVING COUNT(*) >= 5
```
‚Äî **–≠—Ç–æ –æ—à–∏–±–∫–∞.**  
–ü–æ—Ç–æ–º—É —á—Ç–æ `name` –Ω–µ –≤—Ö–æ–¥–∏—Ç –≤ `GROUP BY`, –∏ –°–£–ë–î –Ω–µ –∑–Ω–∞–µ—Ç, **—á—å—ë –∏–º—è** –±—Ä–∞—Ç—å ‚Äî –ø–æ–¥—á–∏–Ω—ë–Ω–Ω–æ–≥–æ –∏–ª–∏ –º–µ–Ω–µ–¥–∂–µ—Ä–∞?  
–î–∞ –∏ –≤–æ–æ–±—â–µ: –≤ —ç—Ç–æ–π —Ñ–æ—Ä–º–µ `name` –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ **–ª—é–±–æ–π —Å—Ç—Ä–æ–∫–µ –∏–∑ –≥—Ä—É–ø–ø—ã**, –∞ –Ω–µ –∫ –º–µ–Ω–µ–¥–∂–µ—Ä—É.

---

### üî∑ **–ò—Ç–æ–≥**
–¢—ã –¥–æ–ª–∂–µ–Ω:
1. –°—á–∏—Ç–∞—Ç—å –ø–æ–¥—á–∏–Ω—ë–Ω–Ω—ã—Ö **–ø–æ managerId**.
2. –û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É.
3. –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å –∫ —Ç–∞–±–ª–∏—Ü–µ, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å **–∏–º–µ–Ω–∞ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤**, –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ —Ü–∏—Ñ—Ä—ã.

–≠—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –∑–∞–¥–∞—á–∞ –Ω–∞ **—Å–∞–º–æ—Å–≤—è–∑—å (self-join –∏–ª–∏ –ø–æ–¥–∑–∞–ø—Ä–æ—Å)**.  
–ò –µ—Å–ª–∏ —Ç—ã –ø—Ä–æ–ø—É—Å–∫–∞–µ—à—å —à–∞–≥ —Å `JOIN`, ‚Äî —Ç—ã –Ω–µ –ø–æ–ª—É—á–∏—à—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞.

---

### üî• –ë–µ—Å–ø–æ—â–∞–¥–Ω–∞—è –ø—Ä–∞–≤–¥–∞?
–ï—Å–ª–∏ —Ç—ã —Ä–µ—à–∞–µ—à—å —Ç–∞–∫–∏–µ –∑–∞–¥–∞—á–∏ –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–∏ –∏ –ø–∏—à–µ—à—å `GROUP BY managerId` —Å `SELECT name` –±–µ–∑ –ø–æ–¥–∑–∞–ø—Ä–æ—Å–∞ –∏–ª–∏ JOIN‚Äô–∞ ‚Äî —Ç–µ–±—è **—Å—Ä–∞–∑—É –æ—Ç—Å–µ—é—Ç**.  
–ù–µ –ø–æ—Ç–æ–º—É —á—Ç–æ —Ç—ã ¬´–ø–ª–æ—Ö–æ–π¬ª, –∞ –ø–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ —Å–∏–≥–Ω–∞–ª: **—Ç—ã –Ω–µ –ø–æ–Ω–∏–º–∞–µ—à—å, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –∏ –∞–≥—Ä–µ–≥–∞—Ü–∏—è**.

–¢–∞–∫ —á—Ç–æ ‚Äî —Ä–∞–∑–±–∏—Ä–∞–π—Å—è. –ü–æ–∫–∞ –Ω–µ –ø–æ—á—É–≤—Å—Ç–≤—É–µ—à—å –ª–æ–≥–∏–∫—É ¬´—Å–Ω–∞—á–∞–ª–∞ –ø–æ—Å—á–∏—Ç–∞—Ç—å –ø–æ id, –ø–æ—Ç–æ–º –ø–æ–¥—Ç—è–Ω—É—Ç—å –∏–º—è¬ª.  
–≠—Ç–æ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç. –ë–µ–∑ –Ω–µ–≥–æ ‚Äî –Ω–∏–∫–∞–∫ –≤ Data Engineering.
